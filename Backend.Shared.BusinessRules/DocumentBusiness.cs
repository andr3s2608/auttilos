using Backend.Shared.Entities.DTOs;
using Backend.Shared.Entities.Interface.Business;
using Backend.Shared.Entities.DTOs.Auttitulos;
using Backend.Shared.Entities.Interface.Repository;
using Backend.Shared.Entities.Responses;
using Backend.Shared.Repositories.Context;
using Backend.Shared.Utilities.Telemetry;
using Microsoft.Extensions.Caching.Distributed;
using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net;
using System.Text;
using System.Threading.Tasks;
using Backend.Shared.Entities.Models.Auttitulos;
using Microsoft.EntityFrameworkCore;
using System.IO;
using iText.Html2pdf;
using iText.Kernel.Pdf;
using iText.Kernel.Events;
using Backend.Shared.Utilities.Utils;

namespace Backend.Shared.BusinessRules
{
    public class DocumentBusiness : IDocumentBusiness
    {
        #region Attributes
        private readonly Utilities.Telemetry.ITelemetryException TelemetryException;
        private readonly IDocuments_typeRepository _repositorydocuments;
        private readonly IDocument_procedureRepository _repositorydocumentsprocedure;
        private readonly IProcedure_requestsRepository _repositoryprocedure;
        private readonly IFormatsRepository _repositoryformats;

        #endregion
        #region Constructor

        /// <summary>
        /// Initializes a new instance of the <see cref="CementerioBusiness"/> class.
        /// </summary>
        /// <param name="oracleContext"></param>
        /// <param name="telemetryException"></param>
        /// <param name="cache"></param>
        public DocumentBusiness(Repositories.Context.dbaeusdsdevpamecContext pamecContext,
            Utilities.Telemetry.ITelemetryException telemetryException,
              IDocuments_typeRepository repositorydocuments,
              IDocument_procedureRepository repositorydocumentsprocedure,
              IProcedure_requestsRepository repositoryprocedure,
              IFormatsRepository repositoryformats,

        IDistributedCache cache)
        {
           
            TelemetryException = telemetryException;
            _repositorydocuments = repositorydocuments;
            _repositorydocumentsprocedure = repositorydocumentsprocedure;
            _repositoryprocedure = repositoryprocedure;
            _repositoryformats = repositoryformats;

        }

        #endregion
        #region Methods


     

        public async Task<ResponseBase<string>> addDocuments(List<DocumentsDTO> documents)
        {
            try
            {
                foreach (DocumentsDTO document in documents)
                {

                    var procedure = await _repositoryprocedure.GetAsync(x => x.IdProcedureRequest.Equals(document.IdProcedureRequest));
                    var documenttype = await _repositorydocuments.GetAsync(x => x.IdDocumentType.Equals(document.IdDocumentType));

                    var documentcreated = new Document_types_procedure();
                                        documentcreated.path = document.path;
                    documentcreated.IdProcedureRequest = document.IdProcedureRequest;
                    documentcreated.IdDocumentType = document.IdDocumentType;
                    documentcreated.is_valid = document.is_valid;
                    documentcreated.modification_date = System.DateTime.Now;
                    documentcreated.registration_date = document.registration_date;                                      

                    await _repositorydocumentsprocedure.AddAsync(documentcreated);

                }
                return new Entities.Responses.ResponseBase<string>(code: HttpStatusCode.OK,
                   message: Middle.Messages.GetOk, data: "documentos actualizados", count: 0);

            }
            catch (Exception ex)
            {
                string msg = ex.Message;
                TelemetryException.RegisterException(ex);
                return new ResponseBase<string>(code: System.Net.HttpStatusCode.OK, message: "ha ocurrido un error mientras se traia la información", data: null);
            }
          
        }

        public async Task<ResponseBase<List<Document_types_procedure>>> getDocumentsbyid(string idrequest)
        {
            try
            {
                var result = await _repositorydocumentsprocedure.GetAllAsync(x => x.IdProcedureRequest.Equals(int.Parse(idrequest)), include: inc => (Microsoft.EntityFrameworkCore.Query.IIncludableQueryable<Document_types_procedure, object>)inc
                                                                                                                                   .Include(i => i.IdDocumentProcNavigation));

                var resultlist = new List<Document_types_procedure>();
                foreach (Document_types_procedure document in result)
                {

                    resultlist.Add(document);
                }


                return new Entities.Responses.ResponseBase<List<Document_types_procedure>>(code: HttpStatusCode.OK,
                    message: Middle.Messages.GetOk, data: resultlist, count: resultlist.Count);

            }
            catch(Exception ex)
            {
                string msg = ex.Message;
                TelemetryException.RegisterException(ex);
                return new ResponseBase<List<Document_types_procedure>>(code: System.Net.HttpStatusCode.OK, message: "ha ocurrido un error mientras se traia la información", data: null);
            }
            throw new NotImplementedException();
        }

        public async Task<ResponseBase<string>> updateDocuments(List<DocumentsDTO> documents)
        {
            try
            {
                foreach (DocumentsDTO document in documents)
                {
                    var documentupdated = new Document_types_procedure();
                    documentupdated.IdDocumentTypeProcedureRequest = document.IdDocumentTypeProcedureRequest;
                    documentupdated.path = document.path;
                    documentupdated.IdProcedureRequest = document.IdProcedureRequest;
                    documentupdated.IdDocumentType = document.IdDocumentType;
                    documentupdated.is_valid = document.is_valid;
                    documentupdated.registration_date = document.registration_date;
                    documentupdated.modification_date = System.DateTime.Now;
                    
                   
                    await _repositorydocumentsprocedure.UpdateAsync(documentupdated);

                }
                return new Entities.Responses.ResponseBase<string>(code: HttpStatusCode.OK,
                   message: Middle.Messages.GetOk, data: "documentos actualizados", count: 0);

            }
            catch (Exception ex)
            {
                string msg = ex.Message;
                TelemetryException.RegisterException(ex);               
                return new ResponseBase<string>(code: System.Net.HttpStatusCode.OK, message: "ha ocurrido un error mientras se traia la información", data: "");
            }
           
        }


        public async Task<ResponseBase<dynamic>> GenerateCertificadoPDF(string idRequest)
        {
            try
            {


                //Imagen de encabezado
                Byte[] bytesEncabezado = Convert.FromBase64String("iVBORw0KGgoAAAANSUhEUgAAAN0AAABdCAYAAAAhdGPCAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABbuSURBVHhe7d0FtC1VGQdwukNSpKVLlJBupBHpDgEBwaV0LrpLpBsJ6QalEQWlpSUUVLq7e1y/zdl3DZu5594Tb859uv9rfeu9M7NnZs/M/u8v99wRioyMjFqRSZeRUTMy6TIyakYmXUZGzciky8ioGZl0GRk1I5MuI6NmZNJlZNSMTLqMjJqRSZeRUTMy6TIyakYmXUZGzciky8ioGZl0GRk1I5MuI6NmZNINp/jiiy8a/2sfzvH2228Xn332WWNLRh3IpBti+PTTT4vnnnuu8auaXFdccUXx8MMPN361j/fee6/41a9+VTz55JONLRl1IJNuiOHOO+8sfvnLXzZ+FcWHH35YXHbZZcUf/vCH4l//+lfx73//u5h77rmL448/vtGifbzxxhvF5JNPXtxxxx2NLRl1IJNuiGHTTTctJpxwwuKZZ54Jv2m+Sy65pFhwwQWLlVZaqVh11VWLEUccsVh22WWLv/71r8UTTzxRfPzxx6Ftq0C6SSaZpLj99tsbWzLqQCbdEMLf/va3YuKJJy5GGGGE4pRTTmlsLYpXXnml2H///YvxxhuvGGmkkcJ+/1900UWL3XbbrXjttdcaLVsD0k022WRZ09WMTLohAr7bxhtvHAhFll566aDlIhBrr7326ttPfvzjHxc33HBD8cEHHzRatYZMut4gk26IgKk4wQQT9BFq3HHHLR544IHG3q9w/vnnh30//OEPi29/+9vF9ttv39jTHjLpeoNMuiEAGm2ttdbqI1wUmi3ik08+KXbYYYdik002KW6++eZgfv785z8v3n333UaL1pFJ1xtk0g1DPPLII8WFF15Y3H///cEv+/zzzxt7vo4bb7wx+Ggp6eaYY47inXfeCW0++uij4ve//30InACT8tZbb+3b3w4y6XqDTLphiH/84x/FOuusUyy33HLFRhttVOy9995BQ1133XWBkAY90qy88srfIBwZddRRi+uvvz6cC2HTKOWXX37ZUWI7k643yKQbhmASXnnllUFjiTp+61vfKqabbrpi/vnnD+H/LbfcMvhlY489diXpyGabbdY4W/eRSdcbZNINY4hKXnrppcUMM8zwDULRZM0IRySvX3jhhcbZuotMut4gk64GCJT87ne/K6aYYopKYg0kZ555ZuNM3UUmXW+QSVcTBEJOOOGEUAFSRaxmsvjiixe33HJLCMZ0E5l0vUEmXRcgoJHinnvuKZ5//vnGr6+gwPiwww4LZV5V5OpPxhhjjGKxxRYrtthii+Lkk08u7rrrro5SBRGZdL1BJl0XIGAifP+nP/0prBAQkVxzzTXDaoAUBvqOO+5YSa6BZOSRRy6mnXbaUHepKPr0008v/vOf/zTO3Doy6XqDTLougM8mSikiKTWw0047FWONNVbx05/+NNRTKl4uh/bPOuusSlK1IlNPPXWxzTbbFA899FDjrK0jk643yKTrEl5++eVQlDzRRBMFcxAxDGhEPPXUU/tybKKZ66677jdINBgZc8wxi7nmmiuYmb/97W/D6oA333wznLcdZNL1Bpl0XYRV2LvvvvvXiLL22muHsq2o6Z566qm+lQStyqyzzlpcffXVxdNPPx3O1Sn+X0g31FbGZ9J1GYqSrXcT+PjOd75THHXUUY09X+Hoo4+uJNRg5Lvf/W5XI5j/66RDttNOO624++67G1uGBjLpuggveZ999il+9rOfFX/84x+LY445JpiccYmOtMEiiyxSSSgyyiijFDPNNFPQjipR0iinqhak7ha6QbpYTxpL0twrSetMy9rGvtg2gtmdHh9/l7fHz1fYVo4al9tEvPrqq6EMr0w67VKU+17ud1WfuoFMui7Ci7npppv6zD9FyZbsiG6CNIIAS5lIZMoppwwRSVFNpFKXKSp50EEHFdNMM83X2lpDVzVw2kEnpLv33nuDFj/wwAOLP//5zyFie+ihh4ZJZr/99gvRXODrSu7bfuyxx4bqGimPgw8+OLQ77rjjQsTXM/r1r39dHHDAAWG7dYIXX3xx+P8hhxwSruMcL730Upi8bNMGkEEqRRvtVQDZpm7VBBb96WeffTYcd99994XfEcip765tv+MQzqcy3GPs0zXXXNM4ojNk0nURcRZOEbers4zkmXTSSYMJqv6SCSQo8vrrr4d2EQayfT/4wQ/6jrPmLq406BTtku7FF18MRdqrrLJK0CQnnnhimGislPjJT34Slh9dddVVIS/pnmn3DTbYIOwTbTWwFQmI7s4777zFLrvsEvoiCLX88suH4y+44IJAyA033DCsLbRK3qcsEAdpbFt99dWDlkKw6aefPjzP9ddfv5hzzjnDBOf4WWaZpdHrojjnnHPCca5XhklO36V5LLFaaKGFQjHC+++/H/qkYF2fzj777MYRnSGTriaYTQ0GHxWyQtyszwQdqK6S9rz88stDVUokngR7N9Au6f7yl7+EftAoUiIG7eOPPx62WUHx6KOPhpXuNMb4448fPqKEbDST54CIUh6PPfZY+NyEwJKPLjGfzz333HA8DUkD+uqZGlXaRntay/9ZALPNNlu4jkltnHHGCc/lwQcfDPWqNJPrIk2E546cCFxeseEYfddfWniBBRYIUWfPh38uxaNPtGw3kElXE5iLzCMawABr1T8w8/ooEb9P2sAs3CnaJR2CKeDedddd+0y1v//9730TAuLQQNtuu23wUaN5HeGzf4JCBrtz0EY02Oijj17sueeewRwVCQamtKJwKRJAMBMQss4zzzzFtddeG7ZbwUGD0nBWcpjUlN25P/C8RH+ZtTPPPHO4hwgTgr7HbXxxboB7cm0Radd/6623wv5OkUlXE7z0TolikG6++eZhIFj42inaJR0iMNWYXUxGfqtUiIG75JJLhiAQcvCnaJUUzDtm3nrrrRf82ZNOOimY0vKbCy+8cNjOhAUayf3GDzWJ3tJezE/m5M477xy2027MQmYvcpnYjjjiiD7SWUjMhKTNkFI1T0QknecL0jJ++xyiYJYvscmtpmV97SKTrsdgPhrEzaQMvhNN4VMOju0E7ZIuQtkbUgnuWLBroNJS8pI0HS2GVGkCX8WOdAryMSlvu+22ELRQ5vab3/wmECNOUCnpmKi0vcln9tlnD8TzHJyPf7nCCisE0rEkaLVIOqYmUqvi0ZZ/GBHNy+gr09YISvMpSDjyyCO/1qdOkUnXQ3iRzCAOfzNJ6yv5Oz7dIIrXCdolHVOQCYksgg/f+973gr9l4PLz+HxIaD9/zQTBPPbpCgN7u+22K2acccYQaOHn8rWYbo5XveN4ph0gHZ9OsAbUnDJNEYH56vy0LPOS70U7jTbaaMHMpOloRRMAMtKEjqO1+HauD5F0oqXeCb9bQEaf+HSuXe5Tp8ik6xG8cFE95kszMWiE0lOYyVMt2CraJR1TTaCBZmEOMg8R0XpB2w1q/lQMehjsIo0rrrhi0IJSIYIVQAPx+wRMEHGZZZYJx/PPgD+oyJs5C0sttVTQ9CDQgjwmIOS1ZtFz0ad999039Ov73/9+SN3QipG4zGF9jZrNhOE3U3m11VYLEVQpEZrNtX/0ox+FPtGc3UAmXY/ANGMmmWEHkvnmm69rpk0Z7ZJOauO8884LmoTGM4FYaoRoJgjbY07Ldp+Ft43pyS+ijRwPIoK0ub+nQFPJi2nrq9aARLQfYoCAhogp2Oe3SQApRVGBv+uagjyI6NnJ40WLgf+I7PEr2p5D7DvLIybTmbxSNmmfOkVT0pllqFSzUJWYKdzAYODGPRTq25IX4uF4mG6uFQgTe6BebDyX8+rTYPtjoGif9ocdXw4nR5gt7RcSb0dcJ5ozsPXWW1cSrEpE9czO3UanPl1Ge2hKOrMQtcqMSEVkii2uCoC9219imD1t5jBTOM6sTdX7WI+okKSpesQYOWoGDrk/pMFBFz4XMo7n8rEf548VEv35O/opF8NZdg9pfyRjzbxpf8zQ9vvQazuifyJqIAKXVpoQTjsTK91O+C/dRiZdb9CUdFS+iFLVIIhioPgEOK2DYGXQGNQ8O1+IuOp4wgnmkCNUf37KP//5z5DwlKOK3/OvEv2Rx2G/8zPKQETOMt9CMrXqeMKX0h8aigkDCMOhr2o/GNFnCVYQ7uagp21UZzB7qu5PmFtiuZvIpOsNmpLOQItrwwYSWqcc3aFRDC6Jz6r2VaLcSY4khX7I/SBU1XFVoswqOt+gP+x7TntV+ypBgph85Q80I+pAgrAievqhfKqqjeS5pDCCpfuQ1ITRTXSLdExvZn2aBM+oRsukY/6IIMnPeGHlfQp2o7YTsu2PcAII/WlQ5I1OM/CDRKuq2hKDuepcTEaaM4JJ2Z/ppj/9aU/mp5A0U1souqrNYMT55dg47+W/WRBFuVRcBS6knu4na6yxRp/m7QY6JZ3jRQ6F4VkhghUKvtPvt3h2LB5SfrcRxop9AiwpWCeuYX/5j2UCF8D2WFwNXJl4LekLJXT2p8f2Ei2TTmLTS5J3UZldnv0lJSUqmZX8q/JxhInJFKW1FLtKbFZpUkGGaGYKcEiOpm34RMxWq6glOlXp+6Ma9gkjq9aPE4CZ2IBNz6E/JhD9UdCqP4IWaTs+pOCN8LHKB+HlKFXtkThtJ0nMPGQ+pu2JPFJMdpsgqrSq9EE3/2pqJ6QzGXr/cnQsEJrYZMJ39Ycry2DxKBsz6SnfSmFStU/xdwrPXTrA/vIkCpZR2c4ViPjFL34RtrmeccCyWWKJJcI15A2HAlomXayBA7PQVFNN1bdPopKJYQZKieK3GzebeZCCCQIeyJcOXD4V7WJWR9LyPkIb8tlEQ4WvDWZhZMERxBFiLsOgSu/DoNYf+wbqjwoGkU55H+FjVRNEAKjKXEV+7eyPbdXz6aucVdqeFhR6j/AMDZS0HaFVuoVOSCeSSzuzNJR+qc6Xe5MXSxfamhRj/5E0DXLFP56ihCuFQoDoViBvGf6Aiu2skQh5Ntu8A/k2z9GEZ5t+pn8JqRdomXTMCGF1QQH+F4LEfSoFaBeJzfIxRHI0XboCzC3aJm3P/xIxTNefGSSKhstAcoEcYXmznwAIX4xIVehz+RyE5uuvP1UD/owzzmi0+DokTtO2qt+rormivFWakQ+XDlRlT1XBFpqkWzm7TkinnEp/aCHHC1p5/mkuS18VGLMqTF7eZ7o0SQTbuYyRFJ5LHGOpTxvdDhNtRLSwWD7GhVSLyc+qBtvVdbaaouo2Wiad8LdUgQfFbyrv8yUsiLNNFLOhSoT+YAYrtyfq8pAm3V6umYtg8gr5i2yabf1rMBDBC6mB8jn4Zszj/kDrlNsTJm8VqjQxM7sqCquEKW1L+MIp+CDM0rQt0nbrzxV3Qjr1lvpTRZQyDHzmtqCU0irHSIKXMSxIJ9VVhtULtiN9TK73Ci2TrpmIvoF8Vnk7X4QJ1x/4KWkgA4E55uVtpByRjGDTp+2iMGeZFeVtXmKz/khPpMEZecEq9Ee6tBjZ9VgCaVtmrkBCFfiraXsi0NINdEI6eUN9ca+CF1WaHbgB2jEF46cHmfBlDAvSMVnL8E6jn0zz9RItk85vFdgkNf3UvDHZ0kGOdGzz/sBcTUlHm/LNyttIlZnHZEjbRTEgqkiXmnNl6E9aotXfjD5Y0hkwaTvCtObDVYGPWTXpCRA0mzQGi05Ip29REwsC+e5nmkfkakQSWEoTJzOBjrKJXAfpvA/Xta8/q6UutEw6g4zpR9j16ezNn7LsorzNg67Kv0V4IeX2xMJB4ed0OxMldcRVkTAZq1IHAiD2l7chVBoJK6OK7F5wFQZDOqamAZW247OVA1Mp+B6CBFXHdaMOsBPSuSeBqxhIMhHwncufB5S7E2XmXsjhmlz4Vp6/esmIOkgHXCP7uBu9RMukUxDqgROzlT90WN5/+OGHV5JIFYiIZAoBmdQcJZaByO+klSxewEUXXfS1OkYDd6uttgoBjHJbwqfT53S7SFkr/SlHF8sYDOmYz3HglEXk1z02gyhoehwRCKryG1tBJ6QDqSFFzAJPJj1iUWkMVEh9mCDcu1pZeUjWkP4rtYuog3S0Ll/fPpNwL9Ey6VRjuwHi4UabPYolFQZzmgBmPiKGAIboFROOJovOdVmEe+OMWfVXSpkJXhp/DamYLc5bFQWN3+8Q3i5vpxX1R7W/czTrj5xbrEhPMRjSqV5P2xCWwkDwDqr+0o+BWDVptIJOSRfBhFdlg2BSQ/ETDtIb+soVQSi+d7SM/D/6gc1Ixy2JYynV7tGvLK9O7490tK73aN8ee+zR2NobtEw6zr2QPRvesgdRqfJ+20DCubw9ihwbR1oyWs4m3e/FlStbhKGrBp2XGxPbxINPfUxiQDhXamJG0X/94UNW9cdkUZXQjRiIdBLzVZpTXwe7cqBqIiDyf52gW6QDWizmZmOeNEY45clEl0n845jMzLca3xyJpKO9U4gRiAnYH5cDRcSVGnz2iEi61IQ0jpi1xpdqlV6iZdLRGB4iJ9oMVt7Hfqd1gIaRKC3vH4wI+ZcrGiTIVYQ0K5huJnFASYpWkWogYQ6V/ZQUA5GONq7KzTGJqpYQVUEOsqoEzbNC6nbRCel8w8SEFv1rzyhqJFFK/ZKX85sLwiUgXA/JbpNZnHQi6aSaWE+OjeIZxXJCqaFougokxXxqTFVBJB1Nqm9K0ozFWO+K9AOZ9MMaTUnHfOEE6+xA4gHzP8pQwjXQqoAoZiFBAyZeCrOdkHN8ia1IeUAxTxRVD7Y/BjXzsxnSyCiRDEY6GjaaQKlIhwwWTCNaIj0HInaipdolHbPQUi2FAXw6wTP+ledqcjTIEZJWQbDUNI/3EldiR03u3dCSCgOiuPcddtgh7GeaIq3rWcJFs3oGCikimJXa+uSCtqwBRNQXGlNlUK/RlHQ0jmU3HmR/4qUhiyqUqlnXLC2kzJyoIrCH5mGa5ZolrA0Q11CRodysiji28dXKkhbRiqLqjyAGYqXnoJX0h39RLqTtD0zc9Jo0nYFp/Z9qk3S/yaPVAtyqqhrSSc6uXdIJ4HhfCGUMqEnVF2OFqe7e5WzdK2vnkyQlwh2wT5kW0FR+e3/OybqKwmwVAxB59Nv1vB/tWV0+seA+IhDMPsKE9461U8jBYioH4HqFpqSjwvlXZrH+xIzTjCzATJWQZGf7Lkhc2MkPY1oIxgx2ECKCD93wF9Qxls8lgc0vKIsgSQr9MQOm/WHy8f3UWA72c2sCR+k144JTUct0H/HMWoXq/DQYRITqy4OuFXSi6fj1yOOZeXZMPWMlfhJBFNu9VtWKOta+mC9TBO43IiNRWQS4QEWTOID3bJJ3PR+tjfsjWFvxXExK/9cvkc801dQrNCUd84iZ1ExaATNRZIvJRvhZ8aOirYJPISRdPpfkrIFUlmZ9TPujZKnV/vAZ0mvGc/A/XCPdP1hfrgzvor91eJawtAN9adenAykjmsizk4crpzA8A+ePPlgZ3kl8FuA88Xcq5ffH1JTfk5iX2ql6tzRZ+XjWRoySDhU0JV3G0ILZmtmUkk7QoJ2cnUHZCeky2kMm3XAEJGFOpqQTIGAyt4pMut4gk244g2BASjrSTlQuk643yKQbzsAHrVpVLp9YFT1uhky63iCTbjgD360qIS/VMZgURxlIp9qnW+vzMgaHTLrhECo+5AJTiZ8iHyyQTj1i1nT1IpNuOIQwuK9cpeJzEK1AeN1q9m5+7ChjYGTS/R9D7k/OcKjlsf7XkUmXkVEzMukyMmpGJl1GRs3IpMvIqBmZdBkZNSOTLiOjZmTSZWTUjEy6jIyakUmXkVEzMukyMmpGJl1GRs3IpMvIqBmZdBkZNSOTLiOjZmTSZWTUjEy6jIyakUmXkVEzMukyMmpGJl1GRs3IpMvIqBVF8V/M3g1WD+ZFPAAAAABJRU5ErkJggg==");

                //Imagen de pie de pagina
                Byte[] bytesPieDePagina = Convert.FromBase64String("iVBORw0KGgoAAAANSUhEUgAAAzkAAABwCAIAAACyzyl3AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAElcSURBVHhe7Z0HXBTH/78VRaRz3NGPdiAIFhAVlKYogqIggiB2UKpKsSChKgqKShEFxYIFxY4FC4q9xMbXXmMvWLB3sf/f3FzuR4iJiSJi/p/Hfd1rZnZmdg/3dp6d3Z2p84kgCIIgCIKorZCrEQRBEARB1F7I1QiCIAiCIGov5GoEQRAEQRC1F3I1giAIgiCI2gu5GkEQBEEQRO2FXI0gCIIgCKL2Qq5GEARBEARReyFXIwiCIAiCqL2QqxEEQRAEQdReyNUIgiAIgiBqL+RqBEEQBEEQtRdyNaKmefXq1Z07d0SRb+Dp06ebNm5Mm5KaPD4pJXnCd1omJiVPTJ6weNGiK1euiDZMEARBEDUIudqXOXnyZFJSUnx8/NGjR0VJ1cqyZcuio6P37duH8Lt37xYuXBgbG7t27Vq2Fnz8+DEjI+PGjRssumLFirt377Lw31NYWHjv3j0EfvvttzFjxiQmJpaVlbFVn+XmzZsJCQnp6enQKZZy69atoqIiFq4uSkpKRo8eLYp8Lblz51q1tlTjqXCVlFSUlb/rwuNwVDjKRgYGw8Mjyu7+3R+QIAiC+CJo1AoKCi5cuCCK/xuePHmSm5u7ZcsWUfxfsm7dulOnTokiPw/kal9gx44dnTt33rBhA/6DLS0tEUUijrP79++zDAgDHD0Iv3///vHjxyz9wYMHLADevHnz9OlTFqicDpYvX96zZ09U27FjxytXrsybN69///6Idu3atbKuycrKYjdY2MXF5ciRIwhA7MSbq8KLFy9gZgoKCqWlpQh369YNP4ycnBxPT8/y8nJRpj8CP3Nzc1u/fv3EiROHDx+OlNOnTzdv3rxfv34sQ3UBV4uKihJF/j341qHDhiorKmhpaBrqCxoZCBoJvvMi3IS+jjZHQd7aqg3EV7QrBEEQxFdhZ2cnJyc3aNCg4uLi58+fi1L/mg8fPhw+fDg6OlpPT6+OkA4dOsyZM+fatWuiHH8Lss2aNcve3h4F0RqKUn8eyNW+AORm7969LHz8+PH//e9/iEJfwsLCfH19nz17lpWV5ejoOGHChNjY2C5duqSmpt6+fTs4ONjf3z8pKQmHV3h4OOwK1wEQPhQZMmQIyr5+/ZrVeefOnZcvX966dQsbOnny5N27dyF8SEeFMTExLA8Mz8PDo3Xr1nl5eYj26tXr8uXLBw8e9PLy6tOnT2ZmJstWGRzTY8eOxXbhfyiOXWLp+Hk8evSIhauA3UDNV69ehZVin5ECt2N7yzJUF/gb/vLLL6LIvydp3HhFWRlDfT0jgUENL8YGBqoc5Q7t2jE1JwiCIL6Obt26MeUCOjo63t7ekydP3rhxIxoIXA9fvHgRnydOnNiyZcu0adP69u2LPKLcf6Rhw4YWFhYRERFoH/fs2XP27FkUBAigsV6yZElUVBQUTV5eXlSgTh1sRbQTPw/kan/H27dvu3fvXqUnDEfS9u3bjx07ZmpqikMBx0FoaCjSoVMTJ05EICQkZPz48dApJyentWvXurm5McfavXs3BGvfvn045nAIVtQlpLy8PDAwEJcI4qe47t27h2NL3E8LscNxjLLQtbKyMlggrLFr166oCmUdHBxwgLKcVYD/nT9/XhT59CklJWXo0KGiyOdITExEERsbmzVr1rCUrVu3Yt9YuLr4Flc7fuy4thZfX1enoq/rRyxGBgIlefmUiSmiHSIIgiD+PZVdrQrQr7p16yIgISHBUng8XsuWLVm4Cg0aNLC0tKxXrx6LskD9+vWRzlL+DLnaf40PHz706NFD3MX66NGj06dP79q1q3fv3rGxsXAahMeMGTN//nys9fX1ZY92QdECAgLCw8NHjRqFDH5+fuyWJQQfFwcJCQmtWrViKZXJyMgYOXIkArAxeNiqVatYOoCrubi4fPz4cdasWf379x8yZMjmzZvd3d3Z2sjIyJycHBauAvLg8oKFc3Nz8V0qdzWjtmHDhuXn57Po0aNHXV1dESgtLXV2dn758iXCcM1a5Wq/REUpK3IaGRhW6fH6J0ujP4bFizjxHy46mhptLS2fPXsm2ieCIAjiX/I3rgY0NTXRtiLQs2fPvLy8e/fuvXnzJisrS0pKSixhCCsoKBw8eBCr0H7Nnj1bX1+fw+HEx8eL1e2zkKv9B5k8eXJwcDAOBQBFy87OxqGzevVqrGrRosW2bdtiYmIgPYhiLXvCbPDgwSzl119/hfd4eXkdPnwYUVwWnD9/HraE4wm+ghQwb9481usG+cO2rl+/3q5du8LCQraWAVdzdHRkbwlAp2RlZS9dugR7Q/3YKwcHh927d7OcVejSpQvrV0tMTPTw8BC/McC4e/fulStXxA/eHT9+HHW+ffv24sWLHTp0YK5WUFAAB2UZqouvdrX37987OTryNTSqyNMXFwiZgb6+tpammgqXx1FiryNoqavr6+ga/inzF5eKqjQ1Dh86JNotgiAI4l/CXK1u3bpoENGuVb5HCdD0oPW0trZGI3vmzJkmTZqoqqr27ds3Pz8fbS4yQNTmzp0Le0OzBT9zcnLC9fP06dPReKFyf39/Vg9DWVnZ3d1dRUWFRcnV/oPAXRISEvz8/AYOHBgXF/fx40eIFLxn9OjR+Ny+fXtmZuby5cuRMzIyEkcVAhAgeFtAQEBgYGBZWdnw4cPZHc+cnBwfHx9oCo7LAwcOVNT+6RNcCjIUFBQ0atQoOBmkCgqIMARRbGzl5eWDBg1irob8yPDw4UPU4O3tjWM3PT0d6Rs2bPjz8Ydqb9269eDBA0NDwwEDBgwbNiwiIuJvnrWCOCJbv3792BcBxcXF4sfmqouvdrUnT562sbTU4WtVuS/594uhQF+Nx+NrqLeztQkKDBw/blxy0vjRkaPc3VyNGzXicTi6fL6RgUGVUn+zwNXUVXiF69aJdosgCIL4l4j71cLCwo4dO8bn8xGWkJAYOXLkpEmTnj59euPGjalTp65Zs2bv3r12dnaWlpZRUVGpqaloyFjBtLS05OTk8PDwZs2aubm5Xbx4cfbs2fPnz0dLevToUbSMPXr0YDnNzMzQdMLnWJRc7T/LYyGiyKdPz58/x9GAwJs3bz4IQfj9+/cwOeH6CsT9Ve/evROnP3r0iGWGArIUBvMwgGpfvXqFKGA9Wwz2woEYVglqFr8ogMyV8zNYKXzC9rD/qBPexsr+FchWufsNe15l09/ON7jaExurNrpa/CodXX+zGOjqNjZs5D9o8IH9IjnGf8Xbt+9Y+P69++lp6c2aNFHjcqsU/JvFUF+goaqyrtJbugRBEMS/omvXrtCmiIiI6OjooKAgGBh7Rs3Pzy8jI8Pf3x8Ghqirq+uYMWMuX76MxmjixIlIgc/Butq0aYMwYLeVNm/eHBsba2BggBQbG5sRI0bA5Dp27IiotLQ0Vnl7e6ekpPj4+CBlw4YNbB9+IsjViJrmq13t6ZOn1m2s/mG/mpGBgb6ODk+ZY2dtg7K3b90eP25cZyenpiYmxoaGbSwtgwL88fPGqrK7d30HDNDV0mok0K9SyWcXQ4FAU1X1x/arseFacD0A+X748GF5+RvRCoIgiJ8Be3t7MzMzBCwsLNTV1RGAvf3Vy54KCgqdOnWytraOj48X35Xavn07VA9mxpzsz8jIyKDCqKiot2/fIjpw4ECU4vF4K1euZDX8RJCrETXNt7jaP+9X09HUam9vf/DAwT69fJw6Oerr6jSoV9+0cWPXrl17uLnZtGnDVVKSlJDo3KnT+fPn3797b9O2LY+jBMMzEgiqVFVlMdSHq6nUsKs9efLk119/zcqaFhYW6u7uZm9v27JlCzOzZmZmzVu0MLOxaevq2i0sbFhOzgz8ef9qCD2CIIhagoODg6Gh4aNHj7S1tWFUSLG1tV2yZMn169fXrFkzadKkJCFTpkzJz8/ftWvXpUuXWEFw4sQJXK+y8IcPH86ePYsMCxYsmDx5MiuVkZFRVFR09+5dFPf19X369ClczcXF5fbt2/Ly8uyJ858LcrW/4/379+y+4cuXL8vKyh4+fChaIQSHiPh+Io4b8a1DdsORhb8a8S1URpUoEG8aO1l5VBHsBht3l4Fo5TcW8UV++AuMNeBqjQQCNRUVy5Ytjx8/PtjPr26dOs6Ojls2b6l8P/fCbxdifvlFj883NTZ2aNeuU0dHl86dtTU1hLr2d0tNutqbN282bdoYGBgAIVNR4TZsWPECVP36EhyOoqoqT11dBQEORwGrEJCTk5GSkkQY6paQEH/ixHFRLQRBELWMTp06cTicbdu27dy5c/369ZAqnNyqvFf3Z/bv35+QkGBmZhYQEDBt2jScIUUr/oKsrKz69evD9pYtW4amJy8vT1JSct1P+LQxudrfASsfMmRI3759LS0tAwMDx44dK1ohZObMmXPnzkXg48ePoaGhFy9eRPjGjRtubm5sFI+v48KFC7179+7Xr9+4cePgFm/fvo2Lixs4cOCAAQPEM0QlJiampqYigMsLLy8vf39/XFIgunfvXnd3d29v78WLFyO6detWT09PrC0uLkZ09+7dPXr0QH5cuyD6o6iBe6BqPG7KxInpqWla6upKcrIjhdMwPH/xfNrUzN69fHq4dY+KHH3y5MmXL1917dIZGSLCw/GnvnnjprHwzmmV2qoshgJ9je9/D7S8/PW8ebl2drZKSgry8jJCM1M1M2vm5+c7cuQIS8tWiCKxUydHZ2cnBLS1tbS0NJo3b8rnayopycvKSmtoqCHzn0eHIQiC+OF07txZSkrKx8cHrdjatWv79+9ft25dtFnnzp1De1e5A6IK3bt319XVbdy4MXuI5bPs2bMHFSKAZhquFhwcjMZx06ZNKCshIQE1ZNl+IsjVvgzkycXFhYXPnDkzb9481hk7fvz4SZMmIYDDy8/P7/r16wgHBQXZ2tpC8l6/fg1jY5J0586dAwcOFBQUsChAZtRTUlKC8PPnz3EMibt8li5dunDhQgQ6duyIzbFhlxGFF7KHKI8fP66oqIitIwwtW7VqFWQRQoZWGVqJOu/du+fk5HTr1i1nZ+dTp069fPkS5oddgqUdPXoUAUdHxx848v737lfT42tbmJnBcfHnaijZYEC/il/s9m3bGhsaSkrUhYoZGxoqysmpq/DMm5u5Coc+QYZjx47hMyY6WkVZuUqFVZYa6FfburW4XTt7+JaMTEO4GlRMR4fPXG3mzBkpKRM1NFRhZoqK8qGhwwIC/FmeNm2sFi5cEBcX07atlZqaiqamupycNEpFRo76q8kqCIIgfgjdunWDnIHhw4eHhobWEVJUVIRTd4MGDWBjqamp4vHhGa9evUJLB8lDI4vGTvzSXmVwER4SEoKq0N4hOmvWLFYzGms0fPA2hOk90P8mv/32G2QcAfjWgAED8vPz+/TpA4GbNm3a7NmzkTh48ODCwkIcOnC4iIgIiN3Zs2c9PT2nTJmCRHg9jj9VVdWsrCw7OztcQFy5cgUHzdSpU5Fz5cqVcDUUr3x7DiQlJbm5ueGoDQsLCw8PR7VwO6Q/e/ZsxIgRsbGxyIAojtqrV68igGw4sn19fdkLqtjPLVu2dOnSBWHQo0cPbKJ3797sSSYEIHxsVc3zTf1qVm10Kl4C+ON8nX9cVLnK0cL6nTt10tbUunu3DBdqajyugZ7eiuXLX716jV84vr6Hu3v9OnUT4uOQM2t6lpyMLC7vzp87r62lZaCvV6XOyovQ1b5Xv9qbN+UxMdHKykrQL8iWg0P72NgYR8eOTNcgZx06tI+O/kVRUU5bW0tBQQ4e1r9/Xw5HUV5edvjw8HXr1nl4uAsEujA5Pl+TGZu0tJSlZau/mtyCIAii5nFycoKT4eRcWlq6f/9+ZlTs7iTaOBZVUVFB87p582bWPqLtQCKPx2Pve4pfMgD3799fuHAhmjzxKLgHDx5Eek5ODsKo5+LFizdu3IClIfrFO621EHK1L3P+/Hk2SUBQUJCfnx8OCFgUJD03Nxf+BIUfOnQoErt27Qr9giFhFY6tQYMGocjDhw9dXV2Rk40oO3369JSUlMlCEMUBimsLBKoARUOFMMJDhw4NFILjDPq1YsUKFNy9e/eyZcvi4iokY/78+d7e3qjW0tISW0ce9tgcAqdOnYK9YfcyMzPNzMzwG+jVqxdztf79+7MuvR/C93Y1aFnxli34/SsrKYQEVUy64OPlzVGQPyj8Yc+ZPTtxzNhbpbfevXvfuZMTMt+4fn37tm1S9eonj6/QX5u2bf9+E9+vX62s7K6bW7eGDRtAsHg85S5dOi9YsGDcuMSJEyc0aFAfcoZ0c/NmcDVIGFSMy+W4una1sWkLk1NXV8WB1727q7V1W4R1dLR4PO7IkSNatbLQ0FCD+aHIggVff2ueIAiiGmHjqzk4OMCfbt68qaGhgShztcePHzdt2hRRMWjg0Ag+ffp069atfx4mDS2jpqYmS2Sw9hEwV7O3t3/y5MmSJUtMTEwQpX61/yZiV4PixMTErF+/HofLpUuX0tPT586dC3tLSkqCp2/btu3KlStwrMTERBw6w4XPSMGcUHbmzJkRERGIZggZN27c7NmzET19+rT47qoYHLWsaxeVjxkzBlqD2hDNy8uD/6G20NBQOzs7CwuLY8eOlZWV7dq1C5cX/v7+BQUFUDTWr4Zsv/322507d7CryAafO3HiBFyNPYnZo0ePCxcuIPBD+H73QCvmJ9DTF+joXrt6dcvmLZISdfMXL8bPW0NNzVf4tnZEWJislJSCrKx58+b46UKsG0hIzMrJKX9dbqCn16tnT+Tx8fbWVFWrUnPl5Tu5Gv7fYV0yMg3FD5/hc9GivMzMqbNm5fTr1xfpsC4OR1FJSV5RUV5ZWQlR9nqB8Jk2WWPjRjA81gOHte7u3adPn4YorA4LsikoyKamThFtjyAI4schHgtXUVHx6tWrAoEAYbgaa/6eP3/u6elZeaooa2trtio+Pp6lsGeK0JZVnvoTzjdjxoyKDQgfJWeu1qVLl3PnzrEMgFztv8mZM2fg/ggsW7bMw8MDqgEbg/pMmjRp+vTpSITDHTlyBF516tQpCNawYcOgUBB5CNyoUaOgd8gDi0INycnJCQkJqAEVFhUVQZ4gfOXl5dAp8Xud2dnZcLKdO3f27Nlz7969v/76KzYK5ULm7du3I/ODBw/Gjh0bFBQE8UJt8B4csn369MGqkSNHYjfmzZvn5eX17t27wYMH5+bm5ufnh4SEoOawsDBoIvYQ6iZ+4bnm+aZ+tb99t8DQQCDQ1TFuZHj37t0l+flS9ett3VqMqzG5hg3T09LwlU2MjPSEsxQoysmtL1yPE4SSvFxsdPT79++bmZo6d3LEVgIGD1ZT4VWpufLyPd4twAFjbd2WvRBgb2+nqakGUYOB9e3be9SokYi2bt1SWloKic7OnX75ZTQuCXbt2nn06NGzZ8+WlBxes2ZNUtJ4rOLzNeTkKl5EgJxlZWVZWbVGWFNTHebXtq0VDA8umJ6eJtoqQRDED0Lsanw+f9asWdLS0gijpcMZGw3WihUr4G3u7u6SkpIsG7h9+zYKojFlUZwGEUV7x6KAy+WidcZFeGZmZmhoKM75c+bMQbq+vj4Ejm0CkKv9N7l//774xUk0inFxcXl5eVArWBS7X7506VIkIg8SYV1sBnd4W2xs7LRp0+ABaFDZQMn79++HbyGwa9curGVvaz5+/BhGJZYnVLJo0SJcOuzYsYOlQMVQPw5iFgUlJSWQOQRevXqVlpaGo5M9g/n06dOJEydC10pLSxG9d+8ee2P0xYsXbO2ECROw9tatW4j+KL5vv5qunoGe/o0bNwrXFUpK1C0oWHX/3j2uslJEeDhq8PLsKddQmqfE0eHzr127dmD/fqn69dOmpL59+9bI0MC9uxvy9OvTR1NFtUrNlZdq71eDc7u7d4eKQapCQoIiI0eZmzfn8ZThWzo6fISlpCSbNDFJSZl49uwZUZm/4OTJE7GxMY0aGXA4Ci1amKmrV7yCoKysNGFC8uLFi7y9vbhcjoKC7JIlogn7CYIgfghiV6sMLApnYzZjAWjQoEFd4WQGjODg4Pz8fFVVVRZt0aLF8uXLLS0tWRRUzszeyWP9alUgVyOIL/NN/Wr/4Hk1DRWVfXv3XvjtgoKMTNTo0Sjo5Oioy+ffvHnz0aNHw0KG9PTw2CU03YH9+/M4SpcvXT537pycTEOWuaODg7amZpU6Ky/V7mrx8XENGzaAVzVv3hRXk7Gx0T4+vWxtbSBqcnIyfL5GauqUf/Ui57VrV0NDh8rLy8DMUG109C9btmyOiAgPCxsGjePxOBoaav/73w97YJEgCOKzrrZWOHffrVu3rK2tRUn/HvZuKbthSq5GEF/J93Y1FWXlSSkTkb9N69amxkavXr3avm27dIMG9ja2J0+cZFU9f/bsl9Gj5aUbqqvwiou3JsTHS0nW37d33+3btyueeNPTrVJn5aV6XW3r1mL2yqe2thaPp9yjR/ctW7aMG5c4atSIevXqurp2O3furCjrv2TDhvWNGxvJykrPmJHt7z9owID+0D4tLQ32PmmbNlaVx0wmCIKoST7rauzdAkZRUVH//v3ZOwf/EDMzs5SUlMuXL4uqIFcjiK/m+90DZYuOhlZ7O3vkz50zR6JOnfjYWIRzZuYoysoqKyo4d3L0cHc3MjCoV6dO3959Zs+a1bxJUx6H07FDxSOJU9MzVDg1N77aixcvrK3bcDiKUChmUfLysj4+vX75JQonlPDwsLd/nOP/33LlymVbW2vUGRERrq+vq6Ghhk0I30hQlZaWiomJFuUjCIKoWZirycjIhONMFxYmKyuLKHM1XGAvXbo0OTnZ3d1dWVm5Qq/+GSoqKt7e3qmpqTt27Kjcr8blcsePH+/j4yMhgTaBXI34N9y4ceP06dOiyJ/AqsrTn32R0tJSNpzM3bt3WYqY9+/fHzp0iI3WURv4fu8WiJaKIdZ4y5YuQxFvz54KMjKzcnIQPvK/I/6DBps1bWZsaOjSufO8ublIvHXrlkVzM46C4v79+2FOLc3NK/rtqlT4x6Ua3y2YNm2ajExDmJOBgb6RkSGPp6ytrcXlcnA2GTVqpCjTt3HvXpm9va2UlKSurjZ0UEFBzsysWatWFtiWmprK0aM0qwFBED8Acb/azJkzoWjQLITZyGdv3ryBqLG1X4GhoWFBQUFlVzM2NsYZfvjw4SwDuRrxL5gzZw4b1+OzwGYmTqy4kfcPuX379rFjx86cOePv7y9K+h1co3Tt2vXPDvej+N79alh0tPjmzZtdvXwlNjpGtmFD6Fro0KFsYgnAXrl9/+F93sKFEDuOvMLSJUuRMjwiQkWZY1RT84E+fvyoefOmSkoK5ubNU1Mnt2tnZ23dVlubD3sLDKz6n/gtwOObN2+GDcEIUfOCBQsyM6fq6GjJykr369dXlIkgCKIGQasEbYqPj09PT2/VqtWJEyfwWXn+w5s3b0LjQkJC7OzsKg/e8VkUFRXHjh27Zs2aKsO8T5kyxc3N7fDhwyYmJqi8T58+yEyu9l9j9+7dubkVvS+QfTYgGY6GWOE9NRxYbDIyrBo6dCg8CeFFixbB5eEEc4XzhIJdu3YFBwcHBAScPHkS1wqTJ08eMmQIDr4rV66sXLkyJSWlqKiITeWJsjiAoBFxcXHI0759+/nz579+/RpaM2DAAGR+9+4dO3ADAwOPHj36+PHj0aNHR0ZGDh48+MaNGxcvXly1ahUOeoFAsG/fvgMHDgwbNiwoKAj7//bt2169et27d4/tEqL4FthEeHj4jh07YHJRUVGDBg1ic5iOGTOGPcYOU2Ry8/79e+ynr69vdnY2ogcPHoQOYh/wF0D0K6gBV4Nv6fH5TRo3dnLsuGP7jgH9+klKSGjwuO5ubpEjR8bHxAYMHmzWtEn9unXMmjZtZmpSsHJV7ty5alyuob5+1ar+tFSXq2VlTWdTSIWEBGHBGSQ9PbVZs6ZWVq2fP6/m+fX37duLbY0YEZGWliopWW/8+PHOzo5cLofHU2bdsQRBEDVJp06d6tevjwCbpeDq1avLly9n0/Mwnjx5grYsLS2NzVIAKr/mKUac2KhRo8zMTLQvbJIDRkZGxtmzZ9GAIgMqf/DgAQKVn4r7WSBX+zuuXbsGDcd/vKurK4wKUVwEQIBKS0unTZsGAcKqmJiYnJycxMREqFizZs1u374NeWf6BbsyNzfHUbJ9+/YtW7aUlZXNmDEDlUCMRo4cCTPDYYR6WO8arAuGh4MJbnfp0qUWLVosXbo0KSlp1KhR58+f9/DwwAGH4jigITo9e/a8e/euqqpqSUnJwoUL/fz8tm3bBvc6cuSIp6cnDG/x4sX79+/fs2ePsbExauvfv7/Y1bBF7MDly5exiVmzZiUkJMA+Ua2TkxPUDZXg0gSZnZ2d2bC6OPrxTVEJaoZ6Ojo64hoFgXbt2n3dpKLf/R7o74uaCq+jgwMzzo0bNnh79jQU6HPk5eWlpTVVVe1tbCdPmvzq1es1q1ercXm6fL6Bnm6VGj67CO+Bfqur4WixtbWBLampqVhYmMPb8DdJTByroaGG05MoU7USHR1tYKA/eXJKfHxcenqavn7FPFRyctJBwqkdCIIgapIuXbpAs9avXz9z5kwlJSW0ZWhiFi1aJFotHHUSDa6hoSGfz+/WrVvXrl3Z02ZVwBl9yJAhaL+gdA4ODmh/xQNggSlTpqCFxVZkZWXxmZ6ejiJsCK2fC3K1LzBu3Lhly5bBZvB/DCc7depUYWFhdnY2tGn06NFQotzc3A8fPqAhXL16NTRr/vz5qampDx8+ZMUhajjCWL/a27dvoXQ4qtzd3WFm7LhBnayjbuzYsXl5ecOGDWPDqk2YMAGrfHx8xD26r169Qn5/f3/oI7h48SKbt+rjx49Qt/z8fFjjb7/9Bi1DItQNOXGMQsggeQMGDBC7GspiLQL4Cqiwb9++bDA2ZpzwMNghvhSbbxT07t171apVLFxUVIQoC3fv3h1qyML/iproVxMuxgaGfHWNxoaNUidPYVr5pvzN9WvXL168JB4Co2hTkburm56WlqGenvGfavjsUi39ajt37uBwFNkIaqqqPCMjQy8vT3V11cDAAFGO6ubx48fGxo3MzJr17OnB3jDQ1tbCFhs1MmAjTBIEQdQYrq6u0CYbGxtY2uXLl9EudOjQAQ0ZW8ueNmOg6USzqKOjg/yNGjUyNzevcLQ6dWxtbSFqCLi4uFR+95M95cJIS0tDg3vhwgU0jmj4oH3Iv2nTJtHqnwdytS+wf/9+CwsLHExxcXFs7oGnT59C4efMmYP/7zZt2ty4cQOJWVlZjo6Oly5dcnZ2njZtmrBoxd1DXCXAEnD84SiEG0GqkD5x4kQYG1wNyj937lx4GxL79esHV0tISEA2ROFh8+bNg+QxTxoxYgTsjc3FvnDhQnjS9evX27dvj+jVq1e9vb2xM3DH06dPDxROpmRmZoadefbsGQJnzpyBkImfV4PAsU1gHxDw8/NjN3OHDh0KdcMvpEePHvgNoJQw+6fQ0NDk5GQEcImTkZGB6xuE8dWsra2xaWGWf0eN9athqbgZqqPNU+Y0MzUd5DtwRnb26oICaFbewoVRkaPtbW3VVVU01dWRrUrBv1mq5d2CkSNHyMlJw5bYoqmpriScsvPKlf8741Q7aWmp9etLcLkcLeEEVmyRk5NZvPj/rmUJgiBqADSjVlZWaLBgWocPH0aDIicnt2HDhufPn/fu3XvZsoqXwxgvX74MCwtD/rFjxy5ZsgTNrlDV6qDxQvsYERHRrl078XNHANelaM5Ys5Wdna2kpIQmcu/evZ07dx40aJCxsfHq1atZzp8IcrUvUF5e7ubmxu4qiiUMlrNx48bS0lIEWMqBAwf69OmDwMiRI3HYITB//nwcMbGxsTieRo0alZmZefLkSchWTExMp06dcHitW7cO+nXx4kUoV3R0NIwQSnfz5k3IEPI3btwYByvcCxcfQUFBqBaXBdgTFIdLwfngiHp6esOGDcNFQ1FREZwSpR48eICjf/fu3VFRUThYUapp06ZHjhzBPkAxUSE2d/78eU9PT9hSixYtoH0wJ2wxPDzcx8fn/v372HPIHCpBYO3atSh75coVbBHfFMKHb5SUlITDvX///hBN5PkKqrFfrdHvizjlLxaBnra2uooKj6OkylNW43F5ykqqXGVtTU1DfcE/KP6H5dv71XA4tW1rxd76FC+KivIDBvSHUh89euTEieMnqpnjJ0+eOHXqJBu5o/J25eVlAwIGi/aMIAiiRmjbti1rQKFZU6dOZfq1ZcuWQ4cO2dnZjRgxwsHBAU0YRI3lv3btWnBwsIyMDMvJEAgE7EFqxsGDByFkqNbDwwOt3rNnz9AQs5xz5sxhnRQQO3Hv3U8EudqXYcfKu3fvxE8svnr1it0RFw9/9eHDB5ZNnHL27Fk2TEZFO/n7fcxbt26VlJQg/d69eziMoFZIvH37NjI8evSI3adD4OjRo9AmFkXjjWO3ovCnT8gPKURLj+LI07Vr1zNnzrC+X2yd3eW8evUqhA8BlEJZVAJLKysrQ8qFCxcgWzk5OZAtmCKEjw0SjYKoVtznjMsaJm2wNFYndhW/AfHXxzcS97p9BdXoaoZ6+gZ6+v9Etn5XOtF4tghUSvx3y7e7GmxMTU2lcucWn6+poCC3adPGKVMmNWoksLAwr7y0bGneqhVk/g+J/2oxN2+Oz3PnzvXu3YvDURBvFwuU0dbW+o1wUn+CIIiagT2vFhoainbKxcWFGdWGDRtwLoqMjHz48GFaWhpSpk+fjsxoTzU1NVmePxMUFMTaLz09PWVlZbRQhYWFM2fORCI+WZ6wsLCLFy96eXkhTM+rETUHLjImTJggivwboIb4JURERLBDWZRag1TXPVBDAURNz1BfH4voBiU87Pc7laJolRSWKAoboLiqsrK+js7/3QP9c5E/pXz7PVBcR8rJyVQWJnV1NQMD/Zs3b7x48Rx+DPOGGT98+ADS/PLlC9gzNB2fL168QArOYrhUePfuLcvw6NFDdqmAcBWg6ZXTkS0xcWzle69YNDTUGjUywKZFO0cQBPH9Yc+rgRUrVrRr146Fd+3aVVJSIiEhwR7acXZ2Zk9Onzp1SjyJO3vDoPI7oZ6ensiD0yOuStesWYPwqFGj4HYITJo0ieUZMGBAZmYmC9OYHQTxZaqrX01TRW3h/AVbi7fqaPEFOrrqPBU1LheLQFfX2NBQR1NLVZkLFdPW0KjIb1DRCaeBPMrCPDo6Brq6JkbGqamprS1aaqmpQ8jUVSpqQCl9bW1jA0OU4qtrCCvhiiqppn41f//BOF8oKsopKIiWevXq2ti0FatzcXHx2LEJrF/22LFje/bszsqafujQIVwvIgXXnZMmpcyZM1uYF2eo5wkJcZs3F7FoZZ49e7Znzx5RRAi7IyDeLhZZWWmI47lz50Q5CIIgvj/isXC3bdsWExPDwjj1wdIaNmxoZWW1b98+Pz+/7t27o8mwtbWVlpa2tLT09fU1MjJCThhbnz59unbtamFhgeisWbOWLFlibW2dnZ29fPlypPj4+GArEyZMqKi3Tp1ly5ZNnz6dhcnVCOLLfFO/2u/zgRoKBFoa6rExMRnpaVrqatC18NCwRXl5cTExFmbNVXlcexu7rGnTcmbO6OzkrKmqaqCnp62pOSQ4ePGiRWPi440bGalyldNSU1Htxg0bba2tVZQ5wUFBK5YvnzJ5cvMmTXX4Wppqal2cnGfl5MzIyu7i7CTQ1WF9bEJX+6Z+talTMwYN8hs6dIh48fPzzRFOrsCIiAjHpeP9+/d/++08bHLz5s1nz57ZsWPH5MmTrly58uTJE21tLZxxYGzIfO3aNYSHDat48gOrdu7cefJkxbSnMD8fH+8BA/rdvHnz1atXFfUKzQ/bqrzpkJDg4OAg8UDBBEEQNYDY1Tp16sR8C7CRz3AG6927t6KiYoMGDaBfoFWrVjj1YRVOhuIONhsbG/ZkDvyMw+EMGDAAn/Xq1RMIBOnp6S9evMCqpKQklrljx47irZCrEcSXqS5X01BTS09LW7QwT4XDWbq0YuKBs2cqpjkfG59gZ23z9OnTO3fuQEHevXvfr28fRVm5XOGkUkeOHHn75s2hg4d0+fxpU6dCaHZu32HVunVCXNybN29Wrlh57erVksMlaioqPr28cSIoLS2FM126eKlxI0OBbsWc7t/erwa7On361NlKnDp1qvLAGTEx0VwuB19h/vzcysOt4US2fv36169fm5k1U1CQk5Sst2RJ/osXz5WU5MeNSzxx4kTz5k0tLVubmhpPmTJ51qwcGZmGBgb6jRoZiM9N+L4XLvx25sxp0YaF4MzIHp0kCIKoGcSuVhnxKLVFRUVZWVkmJiZINDc3R8qKFSsKCwvF7sXAmTM5Ofnhw4c4T7KU0aNHZ2RksKe9wWfnqiJXI4gvUy33QA0FBqrKvE0bNx46eNDF2RlrhwQHcxWVOrRrb2JkvHvX7uPHj+tp89VVVDYXbcbvuX27itncE2JiZSSlugmHPhkeFm5qZAQb69bVRVNN7dmz5/v27u3Zw2NqRgbW9vbu9b+Skr179/I1NJo3adLZydlAV6+67oGGhYVaWJjb2dmIF7jX+PHjRKs/fYqNjVZTUzlz5kx29vT37/9vXMeXL19mZ2fh+rJxY6Nu3VycnBzl5WWnTcvk8zVjY2O8vHqqqHALC9eNHDmiXr26ublzdXT4Q4YEX7x48dkz0UQIcLIuXTq3aWMp3rStrbW5efP16yum4SMIgqgZPutquBYVrRaSnZ0tEAisrKzYKwK5ubkbNmxwcHBAmMvlBgQE4ORmZGSkpqY2Z84cGRkZZ2fnKiNJTZw4UVjxHyBXI4gv8039ar+/W2AoEKjxuGvXrN6xfXtIYOC7d++gaMoKCgoyMjwlpevXrmdnZTWoW6eBhERU5OjS0tKAwYNQQ0eH9moqPL6mxrVr17KmT29pbv7hwwf37m5NTUzevn1bcvjwelzWrV27csXKXl7eD+4/GD9uvGTdOiocDkdevhrfLbh06dKxY8dOnjwhXhCtfIqJiYmGdd28eRPnJvZW75YtWyCOwpS59+7d09XVHjZs6N27dyFtCgqyXC4nIiLc1tamaVPT0aMjhw+PCA8P27Vrp5aWxrhxiaxOBr7m6dOn2BAelbf++PFjUQ6CIIjvj9jVYFp6enosnJWVJVr9O7hAbdWqlbq6+vDhw9nwC0OHDkVOKSkpdlcU17T29vYQtVThMy1VCAwMZDXD+XAiZ2FyNYL4MtXVr6bGVVlfuP7woUMWZmbC25cr2tnZpUxM6dG9e87MmfiF9+7l7dq16507d1cXFPT08EANrl1cNFXVBDq6kB7InFmzpkiMGh2prqKC67Nf9+0zb9a0T2+f+bm5utr89YWFjx496tmjR5B/QHpauqG+oJF+xUgf396vhpOOtrZWkyYm4kVfX7d7dzfRauxS1Gh5edknT54sXLhgwYL5ZWVlJ06cWAszXb26sHDdixcv1NVV+/SpmEACf0w+X6tu3ToJCfG+vgMhbQcO7L9//x5ORgcOHDAw0Hd17VZcXIxvx2o+cuSIoaGBiYmxeNOmpo0FAr29e//wCgJBEMR3hbkaJAwnsZSUlJYtWyoqKrZp00a0uhJwtV69eokinz4FBASgYIMGDZirgVevXiGloKCARcU8fPgQdWpqalpZWS1fvryoqIjNc0CuRhBf5pv61X5/Xs1I+Nrmkvz83bt2K8nLBw4e/PTpU+SBtI2IiNDR0tginIwBQOaMDA08e3ggQxcnJ001NQM93VMnT05NT+coKGzbuq28vLy7q5uDvR1++a9fl79583bTho162jrmzZsdPCCa13zv3r2NjRpV1/NqkZGjpKTqw7fEC4ejaGbW7Pnz5yxDUtI4aBYb3A66lpU1ff78eTjXLFy48OPHjzDIZs2aDBkSzDIXFW3S1NSYNGnS7du3u3Vz0dXVbtWqZbduXW/cuDFt2jRUDpnburWYZc7PXywtLVV50yoqXC0tjUuXRDJHEARRA3Tt2hXapKysHBgYGBwcvHPnTpyy4FV/7lrLzs5OS0sTRT59Wrx4MQq2bt1aPOQnrmb9/f3Pnz/PomLc3Nxgac+ePWPzNw4YMADqhrI0vhpBfJlqcTWhM+m3MDNrZWGBgLqqaktzc0939zaWljpamrrafG0tLRdnZ9eu3fR1dfia6k0aN25rZWViZFQxHptA0LpVK7NmzXS0+cZGRu6ubiirrsIzMTb2cHd3duzE19CAz6EGfR0dN5xROnfR09HR19OpuAdaHa6Wnp4mK/uHQc40NdUhTKdOVby/yRC/uQk+fPhQUlIxGUZubi6by/X169dIFK6s4O3btx8+iMb7gMlVvqH54sULNvYHIzw8VF5etvKmeTxle3tbOK4oB0EQxPfHw8MD2iQpKblr1y49PT0pKSlcnUKnkDhz5szK57cq4Jymra09Z84cUfxz4MKbDXs7ffr0I0eOINC5c+cVK1YgALZs2SLK9/NArkbUNNVyD1Q434ChQEdXX1tb+Mi/QI/P11JT1+XzK3rdDAzgZNoaGnx1jYpJ2Q0MGunp60Ly9AXGgoqB0/S0tVHW2KDi1U6+urqBnp4RwjoVYZRCWdSAbEivSFGHuoleLMDy7a62adNGJSUFPl9TLEwQNWlpqfz8/KtXr2zcuGHHjh27d+/eurW4uHgLPnfs2P7rr/sQWL58WUHBKgR27961c+cOrGUZEEURhLdv37angt1QOuGqrQhjLcKo5MGD+1ZWrZWVlcTbxSInJxMWNky0ZwRBEDXC8OHDoU1ycnK48ty8ebOMjExSUlJeXp6amhrSLSwsRo0aNXny5MzMTCRu2LDhzJkz4mmBzp8/Lw6XlZXhHAcPmzVr1pQpU1AJLI3d6zQ3N1+/fn1gYCCPx7t06dKJEyeQWLdu3W+Zd+dHQa5G1DTf4mptray0NNTFj/n/kAXepsbjfour3bx508BAoK6uqqPDV1NTUVSU19RUx+LrO2Dp0iVdujj37On52cXHp1evXt5VEv/J4uHh7u8/aO7cOdiKvr4utsjlcpirycvL4jQn2jOCIIgaYePGjTAn0KVLF1xbHj16tLy8PD4+niX+GUlJSSMjo6FDhx47dgzFP3z4sHDhQpRVVlYW5fgTUlJS8+bNe/ny5aFDhwoLC6FuSDQ1NRXfPP2JIFcjappvcTV7axsdLb4ajyfu+qqZRTxtqLaGhpa6hq6W5rq1X+9qAP4EYdLQULO0bBUYGLB3796kpHEyMg1PnTolyvEdcHPrZmCgv3v3rokTJ7i4dNbV1VZV5RkbG7HpYgmCIGqMN2/eNGnShEmVhYVFVlZWXFxcdnZ227ZtWeJngX7h08fHp2XLlizlb3BxcYGrRUVFzZw5k8/ns8Rp06aJ9uCnglyNqGm+2tUePnzo1NGxeEvx0JAhGqpqImOrZFTfaRE+Hmegq6XFVVK0btNm7Zo1gf4B+YsXi3brq1iwYL6srLSKCtfLy3PNmjXTp0/X1taSkpL09x8sylHdbNu2VUFBVk5OpkeP7oWF65KTkxo3NpKWlhosHM2EIAiihikqKmL+xDAyMmLP47I3PcVISEi0bt3awMCguLjiHakZM2bIy8vXr19ftPovSE9PR+bFixdzuVxRkvCNhMrP7/5EkKsRNc3Xu9qDh+3s7O7fv4/w1uJij+7u6ioqqjyuQE+3ym3KalwMBQK+hgZXScmsWbOMtDQ2HPaQkCF5CxcKd+orwbcwMTHmcBSbNjWdOXNGcnLy2rVrnJ07NWhQn52PqpdXr163aWMJNVy9umD69Gm41gwLC1VUlFdSUvgZH7MlCOK/weTJk0UaVafO+PHjr127tmzZsps3b4pndgfq6uqnTp3Kzs7u3bu3l5fXggULdu3aZWlpiVUKCgoqKiosW2VCQ0MvX768bt06VMjeVwCwvSoj5f5EkKsRNc23uJqDnX3lH9vmos0D+vYT6OryOBxtTU1DfX3xzcpvXwTaOqpcZTUez97WLmt6VuUbhcGBQYvy8kSRr2XcuEQZGSn4U0hIUEFBQWrqZF/fgdrafNhbtd+UHD06EqeqwED/iRMnQA3x2bJlCzk5mQ4dHN69Ez2iSxAEUfPk5+fr6OgwnWIEBgZmZGSIIsL7nrC0hISE9u3bI2ptbf3mzZvFixdD2tAcnDx5sqSkhL31yahbty6Er0OHDqK4kB49ety6dUu0yZ8QcjWipvmWe6AO9vbX/nRhhN/quLFj7W1stdTVeRwlTXU1fV0dQ4F+lR6yLy8CgYG+no6WFhRNRZnT1MQk0N9/w/r1r16+FG3pd0Kqw9Xu3LnTqJGhgoKcu7tbRkb6ggXzN27c2KxZUykpSaSUl78W5ftm5s6dIylZz8ysWV7egqFDh3Tt2iU8PNTIyFBaWorNo0oQBPEDwbk9MzPTwcGBz+crKCg0aNBAVlYWyiXyLCH29hXzBN68efPo0aN79uyxs7PLzs5GSseOHeFwGhoaonzCYXLl5eXxyeVyTUxM/Pz8Nv8+3ObPC7kaUdN8Y7/an12N8fLlqz27d49PTOzWpYuJkZG6igqPw1Hj8TTV1PT4fIGuLhYDPT1D4YJARYqOjr6OjraGRsW9VGWuCkdZT1vbpk3bISEhK5YvrzyZehWqxdVAZmYGhElVlaenp1NQsCosbNjMmTMgVRISdfz8BlbLmGe4ZuVwFLlcTmxszJixCRs3boAXBgcH1qtX18nJkc3ZQhAEURt4/vx5aWkphOz69evnz5+Hky1YsCAqKqpdu3ZSUlJmZmaenp4Id+rUCU6WlJTk4+ODgJKSUrdu3VJSUtasWQOTu3Tp0g0h9+7d+5tx2n4uyNWImuY7uVplrl27tqFwfVpqmv/gwR7de1i2bNnE2NikUSMBnIjP19Xm6+poGxkamBobNTc1dXZ07Nenb3xs3JL8JceOHhVPHvA3VJerlZeXOzp2kJKStLW1Wbx4UU7OzCVLFsPVjI0b1a8v4eHR486dO6KsX0V6epqSkkK9enWGDRu6d++eFi3MmjdvGhcXq62tqagov2fPblE+giCI2s3Vq1eTk5MFAoGw70yEi4vLxo0b2aQ1/23I1Yia5lvugbb/3D3QL/Lo0aNbpaWXL106fuz4/v37D+w/cOjgIVy04dLtblnZV3RfVZergWPHjmpoqPF4yi4unfv27Q1dGzdurIeHO3tJ08KixebNRaKs/wZcWfbr1wc1KCjIBQYGTJky2dTUZM6c2T17ejRsKAk7jIqKFGUlCIL4Sfj48eOyZcuaNGni5eV19OhRUer/B5CrETVNDfSrfW+q0dWAcPyOhrhGjI7+BWef1NTJhYXrBgzo16BBfcgWh6MYEhJ07txZUe4vcevWrQkTkg0NBSgLC4SoLV68KD4+bsSI4U2bmtrb28rINHRwaP/ixQtRAYIgiJ8K8aQF//9ArkbUNORqfyY+PlZSsp6FRYuYmF8yMzOXLVvap4/PuHFj/fwGKikpQON0dPgBAf5btmyuPNdnZR48eFBcXDxiRISpaeOGDRtA1HR1tc3Nm0+aNDE2NiY0NHT27Fl2djb160sYGze6cOGCqBhBEARR6yFXI2oacrXKfPwomnN92LChkpISMjINraxaL1++LDV1ctu2bUaOHBEVNbpnT08VFa6ERB1lZSUzs2Y+Pj5xcbEZGemZmRkpKRPDwoZ17+7atKkph6MoJyfD4ynDxoYNG5KdnTVjRnZOzkxFRflffokaPNiPzdp+4MABtkWCIAjip4BcjahpyNU+y4cPHyIjRzZoUN/QUODp2SMxcUzv3r3GjUtcvXr1hAnJ0dG/uLh0VlNTkZWVhrSxl9kbNmwAt0MYC0SNTQYPMxszJiEvb0FMTHTbtlaZmZmenh4KCnKSkvUMDPT37dsn2h5BEMTPxsWLF/38/G7cuCGK/38DuRpR09T8uwXVzvdwNcbUqenCNzfr+voOmDUrZ+3aNTk5MwcN8gsPDz18+LC6umpKysS4uNjAwIBevbzhXgKBrp/fwLFjEyIiwoQvuWqqqfE6dnRAHhhefHysigq3ZcsWUEAbm7bfdbJRgiAIMa9evRKFPsetW7cqv9SF8GcH13j//v3Lly+fPn0qzrxo0aIxY8awydfLy8vF9yUYb9++Fb/I/+7duxcvXoirRT3I/OjRIxYF4pzYmWfPnrEwsiEsjtYeyNWImuZ79KuVlJSkTp5S/ro8IT6hna3diIjh+Flev3bdb+BAR4cO4aGhbGYqxkf8q0SV90D/yVOr38/VwNatxa1aWbCusrCw0IyMDEfHjgkJ8Xl5C0ePjjx9+vSWLZsDAvwzMzM3rF/v7u6WnDw+Jyene3dXVVWetrYWFvhZcHDgpEkpnTp1hKXJysoMHTrkrx50IwiCqF527Niho6Mzf/58hA8dOmRhYXHt2jW26ty5c5aWllwuV09Pj43FDaNq0qSJj48Py9C5c+fp06ez8P79+5FNX19fW1s7ICDg9evXjo6Oc+bMwSpYl6Ghoa+vL8vJmDJliq6ubm5uLsJeXl4Is3dFly1bhv0pLi52d3fv378/Uvbs2YNqkd6+fXs1Ienp6WVlZY0bNxYIBNhoq1atsPWKSmsH5GpETfM9XK2goKCnR48d27dra2oe2H9g+7ZtuGZqb28fFBC4/9df3bp26+vTm12B4efXqWPHTh06HD50CJdlQ4KD7axtfAf64nxx8cLFHm7dbdtaT5k0qazsXvL48f16964seWK+q6sBnIZiY2M0NdXr1avr4NCuZ0+PQYP8pk3LLChYOW9e7owZ2T169AgJCZo1a9aGDes9PNz9/Qd7e/dUVlZirsZuhnK5SpKSEh07OvwHxuwmCOIngg1RC91BePv27QhD0RDGlTBkqEOHDkeOHIFLmZmZIXHlypUVj3TUqXPp0iVEVVVVIyNFIwpt2rQJ6fhctWqVhIREcnKyqalpTEwMVs2dOxer6tevL7ZAMHr0aCR6enrifN6gQQOE2eO59vb2CA8cOHDv3r0IbNiwoWXLlm5ubm3btoU4njp1itU2adIkaWlpbOvy5csmJibm5uas2toAuRpR03wPV1tfWOjt5Xn//r3OTk6Dff1ePH9+5MjRFs2as3H5IWFNGjdm48p2c+k6d/acLZs3u7q4REf94t3T6+zZs/369ImOiurXp+/4xHEnjh9vZ2s7NSNjaEiIqbHxzZs3hVv4A9/b1RhnzpwePjxCR4cPY5OXlzExMbazswkMDJg8OQWXmJGRo7p27YLwyJHDHR07eHlVuJq6uiqHoygrK62qyuvSpfPSpUtoZgKCIGqS0tJSZWVlXEkqKSmdOHECJ3xJScnffvsNq/AJJRL3V7F7Gm3atIGctW/ffvjw4Yjq6+vHxsYK13/CdaaUlBQ7dQ8YMADy16xZs8TERESbN28eFxdnZWUVHR0tzFsB6pGVlYWBYetwPnl5eezAxYsXuVzu7Nmz5eTkHjx4EBERAe0zNjb+9ddf69ate+jQIVbW1tYW3qamphYUFJSWlmZkZBQcHMxW1QbI1Yia5ju5Wvdurgh8+PDxl8jRHdu3X7hggXWbNu+FpoITRFMTk7t37yKcPD6pl5f3uLFj2tvbO3bosGrlSiQWb95sb2vdzs6ezSs1cvjw9LTUd2/ftbG0+uxDrDXjaozS0ptz587p1cvLyKhi8tD69etyuRx4m64un8tVkpaWwqeMjJScnAzSkQeKNmFC8v/+VyIqTxAEUYOkpqZCyCZMmADNGjp06PHjxxs0aMBOpFevXsWqgwcPIgxRQ+L58+eREhISYmdnp6KigkRI0tixY4U1fdq2bZvY1QYPHmxmZta0aVPUj4IoFR4e3rp1aw0NDfGDK6GhoTA/e3t7bW1tb29vHR0dXIpD6bADKSkpKDJ+/Pj379/Xq1cP6vbw4UOkoD1iZbEDqE1TU9PZ2RkZ4G0svZZArkbUNF/van/9bsHqgoKunbvcvXN3wbz527dtE+jorl2zxt2te6B/QFFRkXOnTkNDQkRZP32aPWu2irJyQlzcvNzcdrZ269au7eLknJkxdUhwiP/gwaiqRXOzQwcP4QRhamxyvVIHu5iadDUx9+/f37t374IF88eMSQgJCR44sH+fPr39/QeHhg5LSkpC+q5dO2/duiXKTRAEUeNAtgwNDS0sLFxdXdu3b8/lcvPy8qA+a9asOXHixMmTJyFDWAWF8vT0bNas2ZAhQ5SUlNzd3T08PGBO+fn5ELKBAweeOnUKmRFF4ubNm3fu3CktLR0fH29qajplypTIyEiIXffu3VEQGVatWsW27u/v7+LiEhQUhMScnBxoXGFhoZ6enq2tLTYK/UJKWVmZrKwsav748aOuri5WXbp0admyZSgCk5ORkcG1/b59+xCdN28eq7Y2QK5G1DTfo1+t5HBJelr6vXv3QoKCunVxSUtNRWLpzVK4mqtLt7EJY8QvJZ07d865k9PIESNZSsqEiV2cnRLHjP348dOjh4+GhAR3c3FZvGgxVpXdvRsVOfqHPK9GEATxM1JSUgIbY6Ntv379ukmTJiEhISYmJvr6+gYGBo6Ojtu2bYOiwbS0tbXhWDY2Nmlpaaxs3759e/bs6e3tDYVCZjBq1ChjY2OBQIA6sfbFixcdO3aEUVlZWc2ePZuV6tatW79+/Vg4JiYmMDCwoKAAmzt+/LidnV10dHTjxo3Zm1W4lNXS0oKWQdpWrFiBlMOHD2Pf1NXVeTxeYmJiaWkpCrK7osOGDcPOP3z4sKLeWgC5GlHTfIOrPWj/F672z3ny5Mm3j9pPrkYQBPFnyoWIIr8PnIEUfD4XgsSPHz9evnyZXS2zFDGIvnnzBquEeSvCrCxgGYTVl798+ZJFGcjJAtgcux+KgiwFBcVhwCrHJxv1g4GdefDgAQvDL8XDfDx79uyfDAtQM5CrETXNV7vag/v329vZXb9+XRT/cYQEBS9csFAUIQiCIGoZDx8+PHbsmCjy80OuRtQ0X+1quOJx6tjx0sWK97p/LD09PDdu2CCKEARBELWM0aNHx8fHs6Ga/gOQqxE1zVe7GvDt339x3iJR5Afx4P6DDu0dbtNT/ARBEH/NzZs3U1JS4Exjx449e/bshw8fMjIyYmNjo6KiIiMj2Yhr79+/z83NReKoUaNmz57Nbowic2hoqL+//5YtW4Q1VdymHDlyJFLy8/NZyqFDh4KFHD9+/M6dO6hw/PjxEyZMQD1Hjx5FPSEhIefPn2eZGadPn05KSkJOZBPfn3n+/Pm4ceMCAgIKCgpYSu2EXI2oab7F1QrXFXbu5CSK/CAmJif7Dx4sihAEQRCfA6ZVp04db29va2treXn55cuXS0hIODk5QbBgXewG5evXrzkcDjIEBQUhDzTuwoULCCBb7969UXzFihVswLZ27dr5+voiZdq0aWhEJCUl3dzcPDw8pKWlJ0+ePHDgQBUVlXr16vXq1QsaN2/ePOREDWxPGNOnT2eJpqamampqMLx37961bt3axMSEvU8KlRRlrX2QqxE1zbe42sePH3t5eY2JTxDFa5yDBw5amJldFo6vTRAEQfwVcDU5OTkWbtWqFYRMXV0dpnXw4MGSkhL2CD9cjc/njxkzZv/+/dCm5ORkNo4aKxUYGNiiRYuhQ4caGxuzlM2bN6O4nZ1d586dWYqrq2ubNm0QCAgIsLKyYoko1b59ex6PV3kw88zMTENDQwSgaIqKijNmzGDTGJSVlSFx1apVu3btEmasjZCrETXNt7gauHfvXsf27SNHjar56XVXLF9u3txs86ZNojhBEATxFxQXF8PV2HTpQUFB+vr6ampq+ISKQarYq5fl5eXwJ+iaubm5jIwMdMre3j749wkDcnNzoXeOjo69evVCdNCgQR06dIiMjEQlsDqWZ8KECaqqqgj4+vqyWa327NkjKSm5b98+lB03bpwwVwXQRIFAwMKQufj4+Ly8POwSS6nlkKsRNc03uhp48vhxwGB/OxvbuJjoVatW7tyxY/u2rd9p2blje9GmTdMzM7u7unZo3w6/f9FOEARBEH+NuF/t48ePJiYm0CxIVZVT6OvXr2FUbLSzxMRELpfbs2dPAwMDNjmeh4eHjY0NS3/58uXJkydbt27dpEmTLl26tG3bVlhBxRRVqBmBgQMHtmzZEgF/f38JCQlTU1NsvXHjxuLhOSCCqBmBJ0+eSElJzZ49m/WrscfaUCpVODBn7YRcjahpDh8+PGLECFHkGyg5fDguJqavj4+Pl1dvb+/vtKDyXl5eQ4cMKVi1ip0+CIIgiC+ybds2mBBky9jYGJJUXFwsKSkJ02rfvn27du02b96MPHA1CJyhoSG7ZTlo0KDLly9ramqiCGysYcOG27dvf/HiBUrp6elB0WRlZcPDw48fP87hcGBmAAG0KajKy8urRYsWjx8/xkahZaWlpbt370aYiSCYMWMGora2tnw+397ePiQkBC1Rv3791NTULCwssG/Dhw/v1KmTeCy3WgW5GlHTPHv2DL9GUYQgCIL4L3L//v1ly5bNnDkzPz+fTQBQUFCQm5s7a9YsJLIxyT98+ABpmzdvXk5OzoYNG9jYs2VlZdnZ2VOmTBG/yIlWY+7cuUlJSTt27GAp169fTxcifqPz0KFDkDNsdMmSJeLxbwsLC0tKRJMjX7t2Dauw6ZUrV2JD//vf/3799VekL1q0aOLEiefOncNO5uXl1Z7xbytDrkYQBEEQBFF7IVcjCIIgCIKovZCrEQRBEARB1F7I1QiCIAiCIGov5GoEQRAEQRC1F3I1giAIgiCI2gu5GkEQBEEQRO2FXI0gCIIgCKL2Qq5GEARBEARReyFXIwiCIAiCqL2QqxEEQRAEQdReyNUIgiAIgiBqL+RqBEEQBEEQtRdyNYIgCIIgiNoLuRpBEARBEETthVyNIAiCIAii9kKuRhAEQRAEUXshVyMIgiAIgqi9kKsRBEEQBEHUXsjVCIIgCIIgai/kagRBEARBELUXcjWCIAiCIIjaC7kaQRAEQRBE7YVcjSAIgiAIovZCrkYQBEEQBFF7IVcjCIIgCIKovZCrEQRBEARB1F7I1QiCIAiCIGov5GoEQRAEQRC1F3I1giAIgiCI2sqnT/8PPZowhHXCbPYAAAAASUVORK5CYII=");


                // LLaves a reemplazar en el formato del certificado de aguas
                string[] keys = { "~:~nombre_solicitante~:~",
                    "~:~tipo_documento~:~",
                    "~:~numero_id~:~",
                    "~:~nombre_titulo~:~",
                    "~:~nombre_institucion~:~",
                    "~:~fecha_titulo~:~",
                    "~:~numero_acta~:~",
                    "~:~numero_libro~:~",
                    "~:~numero_folio~:~",
                    "~:~anio_titulo~:~",
                    "~:~numero_de_resolucion~:~",
                    "~:~dia_de_resolucion~:~",
                    "~:~mes_de_resolucion~:~",
                    "~:~anio_de_resolucion~:~",
                    "~:~nombre_subdirector~:~"};

                string[] meses = { "Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre" };

                //Valores dinamicos a cargar en el certificado de aguas

                DateTime dateTime = DateTime.Now;

                var solicitud = await _repositoryprocedure.GetAsync(s => s.IdProcedureRequest == int.Parse(idRequest));

                // Console.WriteLine(solicitud.IdSolicitud);

                Console.Write(solicitud.end_date.ToString("yyyy-MM-dd"));

                string[] values = {
                    solicitud.AplicantName,
                    solicitud.IdDocument_type,
                    solicitud.IdNumber,
                    solicitud.name_profession,
                    solicitud.name_institute,
                    solicitud.end_date.ToString("yyyy-MM-dd"),
                    solicitud.graduation_certificate,
                    solicitud.book,
                    solicitud.folio,
                    solicitud.year_title+"",
                    "xxxx",
                    dateTime.Day.ToString().Length > 1 ? dateTime.Day.ToString() : "0" + dateTime.Day.ToString(),
                    meses[dateTime.Month - 1].ToUpper(),
                    dateTime.Year.ToString(),
                    "DORA DUARTE PRADA"
                   };



                //Control de certificado de acuerdo al tipo de solicitante

                Formats formato;

                formato = await _repositoryformats.GetAsync(s => s.IdFormat == int.Parse("1"));


                //Convertir HTML TO PDF y guardarlo en memoria

                MemoryStream stream = new MemoryStream();

                HtmlConverter.ConvertToPdf(DynamicChange(formato.Body, keys, values), stream);

                //Crear otras isntaciaas de MemoryStream

                //Para obtener acceso al pdf trasformado del html se almacena el array de bytes en un nuevo MemoryStream

                MemoryStream pdfStream = new MemoryStream(stream.ToArray());

                MemoryStream outputPDF = new MemoryStream();


                //Crea el PdfDocument a partir del MemoryStream de la conversion y mapear su almacenamiento en un nuevo MemoryStream


                PdfDocument pdfDoc = new PdfDocument(new PdfReader(pdfStream), new PdfWriter(outputPDF));

                // Añade el EventHandler

                pdfDoc.AddEventHandler(PdfDocumentEvent.END_PAGE, new MyEvent(bytesPieDePagina));

                // Cierra el PdfDocument
                pdfDoc.Close();

                //Se extrae el array de bystes del pdf resultante del proceso

                byte[] docBytes = outputPDF.ToArray();

                return new Entities.Responses.ResponseBase<dynamic>(code: HttpStatusCode.OK, message: "Certificado generado", data: docBytes);
            }
            catch (System.Exception ex)
            {
                var ExcepcionMessage = "";
                Exception innerExcepcion = ex;
                while (innerExcepcion != null)
                {
                    ExcepcionMessage += innerExcepcion.Message;
                    innerExcepcion = innerExcepcion.InnerException;
                }
                TelemetryException.RegisterException(ex);
                return new Entities.Responses.ResponseBase<dynamic>(code: HttpStatusCode.InternalServerError, message: ExcepcionMessage);
            }
        }

        public string DynamicChange(string body, string[] keys, string[] values)
        {
            for (int i = 0; i < keys.Length; i++)
            {
                if (keys[i] == "~:~firma~:~")
                {
                    body = body.Replace(keys[i], values[i]);
                }
                else
                {
                    body = body.Replace(keys[i], values[i].ToUpper());
                }

            }
            return body;
        }


        #endregion


    }
}
